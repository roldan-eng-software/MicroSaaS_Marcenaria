version: '3.8'

services:
  # O Backend agora atua como um Proxy ou Processador de Lógica Adicional (se necessário)
  # Para o MVP focado em Supabase, ele pode ser opcional, mas mantemos para extensões futuras.
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    container_name: marcenaria-backend
    ports:
      - "8000:8000"
    env_file:
      - ./backend/.env
    restart: unless-stopped

  # Frontend servido via Nginx
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    container_name: marcenaria-frontend
    ports:
      - "80:80"
    # Note: Vite build-time env vars precisam estar no .env do frontend ou passadas como build args.
    # No docker-compose, elas funcionam para runtime se o app as ler (o que SPAs não fazem sem ajuda).
    # Para o build no Dockerfile, o ideal é ter o .env presente no contexto.
    restart: unless-stopped

# Volumes removidos pois o banco está no Cloud (Supabase)
