version: '3.8'

services:
  # O Backend agora atua como um Proxy ou Processador de Lógica Adicional (se necessário)
  # Para o MVP focado em Supabase, ele pode ser opcional, mas mantemos para extensões futuras.
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    container_name: marcenaria-backend
    ports:
      - "8000:8000"
    env_file:
      - ./backend/.env
    restart: unless-stopped

  # Frontend servido via Nginx
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
      args:
        - VITE_SUPABASE_URL=${VITE_SUPABASE_URL}
        - VITE_SUPABASE_ANON_KEY=${VITE_SUPABASE_ANON_KEY}
    container_name: marcenaria-frontend
    ports:
      - "80:80"
    env_file:
      - ./frontend/.env
    restart: unless-stopped

# Volumes removidos pois o banco está no Cloud (Supabase)
